<!DOCTYPE html>
<html>
<canvas id = 'canvas' width = '600' height = '600' style = 'border:1px solid #000000'> </canvas>

<script>
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');

var cvsW = canvas.width;
var cvsH = canvas.height;

var tileList = [];
var geboList = [];
var coalList = [];

var tileWidth = 60;
var tileHeight = 60;

const GRID_COLS = 10;
const GRID_ROWS = 10;

var turn = 0;

function init() {
  setInterval(updateAll,20);
}

function updateAll() {
  ctx.clearRect(0,0,cvsW,cvsH);
  updateTiles();
  updateCoal();
  updateGebo();
}

init();

//////////////////////////////////////////////////

function changeTurn() {
 turn += 1;
 geboTurnHandling();
}

//////////////////////////////////////////////////

document.addEventListener('keydown',keydown);

function keydown(evt) {
  var key = evt.keyCode;
  switch (key) {
    /////// 1
    case 49:
    createGebo(55);
    checkTiles();
    console.log('geboList.length: ' + geboList.length);
    break;
    ////// SPACE
    case 32:
    changeTurn();
    console.log('space');
    break;
    ////// LEFT
    case 37:
    geboList[0].moveGebo('left');
    console.log('left');
    break;
    ////// UP
    case 38:
    geboList[0].moveGebo('up');
    console.log('up');
    break;
    ////// RIGHT
    case 39:
    geboList[0].moveGebo('right');
    console.log('right');
    break;
    /////// DOWN
    case 40:
    geboList[0].moveGebo('down');
    console.log('down');
    break;

    default:
    console.log('default');
    break;
  }
}




/////////////////////////////////////////////////

class Tile {
  constructor (x,y,width,height,tileID) {
    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
    this.width = tileWidth;
    this.height = tileHeight;
    this.color = 'white';
    this.tileID = tileID;
    this.tileID = null;

    this.tileOccupant = null;
  }
  getColor() {
    var rando = Math.floor(Math.random()*10);
    switch(rando) {
      case 0:
      this.color = 'red';
      break;
      case 1:
      this.color = 'black';
      break;
    }
  }
  drawTile() {
    ctx.save();
    ctx.beginPath();
    ctx.lineWidth = 0.2;
    ctx.rect(this.x,this.y,this.width,this.height);
    ctx.fillStyle = this.color;
    ctx.fill();
    ctx.stroke();
    ctx.restore();

    ctx.save();
    ctx.fillStyle = 'black';
    ctx.font = '10px Arial';
    if (this.color == 'black') {
      ctx.fillStyle = 'white';
    }
    ctx.fillText(this.color,this.x+3,this.y+10);
    ctx.fillText('tileID: ' + this.tileID, this.x+3,this.y+tileHeight/2 -5);
    ctx.restore();
  }
  updateTile() {
  //
  }
}

function updateTiles() {
  for (i=0;i<tileList.length;i++) {
    tileList[i].drawTile();
    tileList[i].updateTile();
  }
}
function createTile(x,y) {
  var tile = new Tile (x,y);
  tileList.push(tile);
//  tile.getColor();
  tile.tileID = tileList.indexOf(tile);
}
function createGrid() {
  for (i=0;i<GRID_COLS;i++) {
    for (j=0;j<GRID_ROWS;j++) {
      var tileX = i * tileWidth;
      var tileY = j * tileHeight;
      createTile(tileX,tileY);
    }
  }
}

  createGrid();



console.log(navigator.appVersion);

</script>
<script src = 'gebo.js'></script>
<script src = 'resources.js'></script>
</html>
